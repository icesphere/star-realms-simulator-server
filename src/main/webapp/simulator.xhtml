<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

<ui:composition template="/templates/commonLayout.xhtml">
    <ui:define name="content">
        <h:form id="simulatorForm">

            <p:remoteCommand name="runSimulation" actionListener="#{simulatorView.runSimulation}" process="simulatorForm" update="submitButton results"/>

            <h:panelGroup id="simulatorPage" layout="block" styleClass="simulatorPage">

                <h2>Star Realms Simulator</h2>

                <h:panelGroup id="instructions" layout="block" styleClass="bigTopMargin">
                    <h3>Instructions</h3>
                    <div class="bigTopMargin">
                        Enter the current game state, and then click submit to see your win percentage.
                        <br/><br/>
                        To enter cards just enter a list of card names separated by commas. Example: Scout, Viper, Scout, Viper, Explorer, Blob World, Scout, Battle Station
                        <br/><br/>
                        The starter cards and explorers can also be abbreviated to their first letter and capitalization and spaces are not required so the above example could also be: s, v, s, v, e, blobworld, s, battlestation
                        <br/><br/>
                        If the trade row is left blank it will randomly draw 5 cards for the trade row.
                        <br/><br/>
                        If all cards for a player are left blank it will use starter cards and randomly draw a hand from the starter cards.
                        <br/><br/>
                        Bot descriptions:
                        <br/>
                        Attack Bot - Favors attack
                        <br/>
                        Defense Bot - Favors lifegain/bases
                        <br/>
                        End Game Bot - Does not buy any cards and always scraps for benefit
                        <br/>
                        ExpensiveBot - Always buys the most expensive card
                        <br/>
                        HareBot - Combination of attack and scrap
                        <br/>
                        RandomBot - All cards are considered the same value, so it just buys random cards
                        <br/>
                        TortoiseBot - Combination of defense and scrap
                        <br/>
                        VelocityBot - Favors scrap and velocity
                    </div>
                </h:panelGroup>

                <h:panelGroup id="gameState" layout="block">
                    <div class="bigTopMargin">
                        <h3>Game Info</h3>

                        <h:panelGrid styleClass="bigTopMargin" columns="2" columnClasses="boldText smallRightPadding tinyBottomPadding alignTop, tinyBottomPadding alignTop">

                            <h:outputLabel value="Turn: "/>
                            <h:inputText style="width: 40px;" value="#{simulatorView.gameState.turn}" pt:type="number"/>

                            <h:outputLabel value="Is it your turn? "/>
                            <h:selectOneRadio value="#{simulatorView.gameState.currentPlayer}" styleClass="radioSpacing">
                                <f:selectItem itemLabel="Yes" itemValue="Y"/>
                                <f:selectItem itemLabel="No" itemValue="N"/>
                                <f:selectItem itemLabel="Random" itemValue="R"/>
                            </h:selectOneRadio>

                            <h:outputLabel value="Include Year One Promos? "/>
                            <h:selectOneRadio value="#{simulatorView.gameState.includeYearOnePromos}" styleClass="radioSpacing">
                                <f:selectItem itemLabel="Yes" itemValue="Y"/>
                                <f:selectItem itemLabel="No" itemValue="N"/>
                                <f:selectItem itemLabel="Random" itemValue="R"/>
                            </h:selectOneRadio>

                            <h:outputLabel value="Include Bases and Battleships? "/>
                            <h:selectOneRadio value="#{simulatorView.gameState.includeBasesAndBattleships}" styleClass="radioSpacing">
                                <f:selectItem itemLabel="Yes" itemValue="Y"/>
                                <f:selectItem itemLabel="No" itemValue="N"/>
                                <f:selectItem itemLabel="Random" itemValue="R"/>
                            </h:selectOneRadio>

                            <h:outputLabel value="Include Gambits? "/>
                            <h:selectOneRadio value="#{simulatorView.gameState.includeGambits}" styleClass="radioSpacing">
                                <f:selectItem itemLabel="Yes" itemValue="Y"/>
                                <f:selectItem itemLabel="No" itemValue="N"/>
                                <f:selectItem itemLabel="Random" itemValue="R"/>
                            </h:selectOneRadio>

                            <h:outputLabel value="Trade row: "/>
                            <h:inputTextarea cols="40" rows="3" value="#{simulatorView.gameState.tradeRow}"/>

                        </h:panelGrid>

                    </div>

                    <div class="bigTopMargin">
                        <h3>Your Info</h3>

                        <h:panelGrid styleClass="bigTopMargin" columns="2" columnClasses="boldText smallRightPadding tinyBottomPadding alignTop, tinyBottomPadding alignTop">

                            <h:outputLabel value="Bot Name: "/>
                            <h:selectOneMenu value="#{simulatorView.gameState.bot}">
                                <f:selectItem itemLabel="Attack Bot" itemValue="AttackBot"/>
                                <f:selectItem itemLabel="Defense Bot" itemValue="DefenseAndBaseBot"/>
                                <f:selectItem itemLabel="End Game Bot" itemValue="EndGameBot"/>
                                <f:selectItem itemLabel="Expensive Bot" itemValue="ExpensiveBot"/>
                                <f:selectItem itemLabel="Hare Bot" itemValue="HareBot"/>
                                <f:selectItem itemLabel="Random Bot" itemValue="RandomBot"/>
                                <f:selectItem itemLabel="Tortoise Bot" itemValue="TortoiseBot"/>
                                <f:selectItem itemLabel="Velocity Bot" itemValue="VelocityBot"/>
                            </h:selectOneMenu>

                            <h:outputLabel value="Authority: "/>
                            <h:inputText style="width: 40px;" value="#{simulatorView.gameState.authority}" pt:type="number"/>

                            <h:outputLabel value="Hand: "/>
                            <h:inputTextarea cols="40" rows="3" value="#{simulatorView.gameState.hand}"/>

                            <h:outputLabel value="Deck: "/>
                            <h:inputTextarea cols="40" rows="3" value="#{simulatorView.gameState.deck}"/>

                            <h:outputLabel value="Discard: "/>
                            <h:inputTextarea cols="40" rows="3" value="#{simulatorView.gameState.discard}"/>

                            <h:outputLabel value="Bases in Play: "/>
                            <h:inputTextarea cols="40" rows="3" value="#{simulatorView.gameState.basesInPlay}"/>

                            <h:outputLabel value="Gambits: "/>
                            <h:inputTextarea cols="40" rows="3" value="#{simulatorView.gameState.gambits}"/>

                        </h:panelGrid>

                    </div>

                    <div class="bigTopMargin">
                        <h3>Opponent Info</h3>

                        <h:panelGrid styleClass="bigTopMargin" columns="2" columnClasses="boldText smallRightPadding tinyBottomPadding alignTop, tinyBottomPadding alignTop">

                            <h:outputLabel value="Bot Name: "/>
                            <h:selectOneMenu value="#{simulatorView.gameState.opponentBot}">
                                <f:selectItem itemLabel="Attack Bot" itemValue="AttackBot"/>
                                <f:selectItem itemLabel="Defense Bot" itemValue="DefenseAndBaseBot"/>
                                <f:selectItem itemLabel="End Game Bot" itemValue="EndGameBot"/>
                                <f:selectItem itemLabel="Expensive Bot" itemValue="ExpensiveBot"/>
                                <f:selectItem itemLabel="Hare Bot" itemValue="HareBot"/>
                                <f:selectItem itemLabel="Random Bot" itemValue="RandomBot"/>
                                <f:selectItem itemLabel="Tortoise Bot" itemValue="TortoiseBot"/>
                                <f:selectItem itemLabel="Velocity Bot" itemValue="VelocityBot"/>
                            </h:selectOneMenu>

                            <h:outputLabel value="Authority: "/>
                            <h:inputText style="width: 40px;" value="#{simulatorView.gameState.opponentAuthority}" pt:type="number"/>

                            <h:outputLabel value="Hand and Deck: "/>
                            <h:inputTextarea cols="40" rows="3" value="#{simulatorView.gameState.opponentHandAndDeck}"/>

                            <h:outputLabel value="Discard: "/>
                            <h:inputTextarea cols="40" rows="3" value="#{simulatorView.gameState.opponentDiscard}"/>

                            <h:outputLabel value="Bases in Play: "/>
                            <h:inputTextarea cols="40" rows="3" value="#{simulatorView.gameState.opponentBasesInPlay}"/>

                            <h:outputLabel value="Gambits: "/>
                            <h:inputTextarea cols="40" rows="3" value="#{simulatorView.gameState.opponentGambits}"/>

                        </h:panelGrid>

                    </div>

                    <div style="padding-top: 30px;">

                        <h:panelGrid columns="2" columnClasses="boldText smallRightPadding tinyBottomPadding alignTop, tinyBottomPadding alignTop">

                            <h:outputText value="Number of times to simulate: "/>
                            <h:selectOneMenu value="#{simulatorView.timesToSimulate}">
                                <f:selectItem itemLabel="100" itemValue="100"/>
                                <f:selectItem itemLabel="1,000" itemValue="1000"/>
                                <f:selectItem itemLabel="10,000" itemValue="10000"/>
                            </h:selectOneMenu>

                        </h:panelGrid>

                        <h:panelGroup id="submitButton" layout="block">
                            <p:commandButton rendered="#{!simulatorView.loadingResults}" process="@this" update="submitButton results" onsuccess="runSimulation()" style="margin-top: 20px;" value="Submit" actionListener="#{simulatorView.startSimulation}"/>
                        </h:panelGroup>

                    </div>

                </h:panelGroup>

                <h:panelGroup id="results" layout="block">
                    <h:panelGroup layout="block" rendered="#{simulatorView.showResults}" styleClass="bigTopMargin">

                        <h:panelGroup layout="block" rendered="#{simulatorView.loadingResults}">
                            <h:graphicImage library="images" name="loadingSmall.gif"/>
                        </h:panelGroup>

                        <h:panelGroup layout="block" rendered="#{!simulatorView.loadingResults}">

                            <h:panelGroup layout="block" rendered="#{simulatorView.showErrors}">

                                <h2>Errors</h2>

                                <h:dataTable style="color: #cc0000" value="#{simulatorView.errorMessages}" var="errorMessage">
                                    <h:column>
                                        <h:outputText value="#{errorMessage}"/>
                                    </h:column>
                                </h:dataTable>

                            </h:panelGroup>

                            <h:panelGroup layout="block" rendered="#{!simulatorView.showErrors}">

                                <h2>Results</h2>

                                <h:panelGrid styleClass="bigTopMargin" columns="2" columnClasses="boldText smallRightPadding tinyBottomPadding alignTop, tinyBottomPadding alignTop">

                                    <h:outputLabel value="Win Percentage: "/>
                                    <h:panelGroup>
                                        <h:outputText value="#{simulatorView.results.winPercentage}">
                                            <f:convertNumber pattern="##.00"/>
                                        </h:outputText>
                                        <h:outputText value="%"/>
                                    </h:panelGroup>

                                    <h:outputLabel value="Avg # Turns: "/>
                                    <h:outputText value="#{simulatorView.results.averageNumTurns}">
                                        <f:convertNumber pattern="##.00"/>
                                    </h:outputText>

                                </h:panelGrid>

                            </h:panelGroup>

                        </h:panelGroup>

                    </h:panelGroup>
                </h:panelGroup>

            </h:panelGroup>
        </h:form>
    </ui:define>
</ui:composition>
</html>